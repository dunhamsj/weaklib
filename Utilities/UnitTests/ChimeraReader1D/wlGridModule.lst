


PGF90 (Version     14.9)          03/12/2015  00:11:47      page 1

Switches: -noasm -nodclchk -debug -nodlines -line -list
          -idir /opt/cray/hdf5/1.8.13/PGI/141/include
          -idir /opt/cray/mpt/7.0.4/gni/mpich2-pgi/141/include
          -idir /opt/cray/rca/1.0.0-2.0502.53711.3.127.ari/include
          -idir /opt/cray/xpmem/0.1-2.0502.55507.3.2.ari/include
          -idir /opt/cray/gni-headers/3.0-1.0502.9684.5.2.ari/include
          -idir /opt/cray/pmi/5.0.4-1.0000.10161.132.4.ari/include
          -idir /opt/cray/ugni/5.0-1.0502.9685.4.24.ari/include
          -idir /opt/cray/udreg/2.3.2-1.0502.9275.1.12.ari/include
          -idir /opt/cray/alps/5.2.1-2.0502.9072.13.1.ari/include
          -idir /opt/cray/wlm_detect/1.0-1.0502.53341.1.1.ari/include
          -idir /opt/cray/alps/5.2.1-2.0502.9072.13.1.ari/include
          -idir /opt/cray/krca/1.0.0-2.0502.53880.4.104.ari/include
          -idir /opt/cray-hss-devel/7.2.0/include
          -inform severe -opt 0 -nosave -object -noonetrip
          -depchk on -nostandard     
          -symbol -noupcase    

Filename: ../../../Distributions/Source/wlGridModule.f90

(    1) MODULE wlGridModule
(    2) 
(    3)   USE wlKindModule, ONLY: dp
(    4)   USE wlThermoStateModule
(    5) 
(    6)   implicit none
(    7)   PRIVATE
(    8) 
(    9)   PUBLIC MakeLinearGrid
(   10)   PUBLIC MakeLogGrid
(   11) 
(   12) CONTAINS 
(   13) 
(   14)   SUBROUTINE MakeLinearGrid( LowerBound, UpperBound, nPoints, Grid )
(   15) 
(   16)     INTEGER, INTENT(in)               :: nPoints  
(   17)     REAL(dp), INTENT(in)              :: LowerBound
(   18)     REAL(dp), INTENT(in)              :: UpperBound 
(   19)    
(   20)     REAl(dp), DIMENSION(nPoints), INTENT(out)   :: Grid 
(   21) 
(   22)     Integer  :: m
(   23)     REAL(dp) :: BinWidth
(   24) 
(   25)     BinWidth = ( UpperBound - LowerBound ) / DBLE( nPoints - 1 )
(   26) 
(   27)     Grid(1) = LowerBound
(   28)  
(   29)     DO m = 2, nPoints - 1
(   30)       Grid(m) = Grid(m-1) + BinWidth
(   31)     END DO
(   32) 
(   33)     Grid(nPoints) = UpperBound
(   34) 
(   35)   END SUBROUTINE MakeLinearGrid
(   36) 
(   37)   SUBROUTINE MakeLogGrid( LowerBound, UpperBound, nPoints, Grid )
(   38) 
(   39)     Integer, INTENT(in)      :: nPoints          






PGF90 (Version     14.9)          03/12/2015  00:11:47      page 2

(   40)     REAL(dp), INTENT(in)     :: LowerBound
(   41)     Real(dp), INTENT(in)     :: UpperBound
(   42) 
(   43)     REAl(dp), DIMENSION(nPoints), INTENT(out)   :: Grid 
(   44) 
(   45)     Integer  :: m
(   46)     REAL(dp) :: ScaleFactor
(   47) 
(   48)     ScaleFactor =  EXP( LOG( UpperBound / LowerBound ) / DBLE( nPoints - 1 ) )
(   49) 
(   50)     Grid(1) = LowerBound
(   51) 
(   52)     DO m = 2, nPoints - 1
(   53)       Grid(m) = Grid(m-1) * ScaleFactor
(   54)     END DO
(   55) 
(   56)     Grid(nPoints) = UpperBound
(   57) 
(   58)   END SUBROUTINE MakeLogGrid
(   59) 
(   60) END MODULE wlGridModule
