


PGF90 (Version     14.9)          03/12/2015  00:11:49      page 1

Switches: -noasm -nodclchk -debug -nodlines -line -list
          -idir /opt/cray/hdf5/1.8.13/PGI/141/include
          -idir /opt/cray/mpt/7.0.4/gni/mpich2-pgi/141/include
          -idir /opt/cray/rca/1.0.0-2.0502.53711.3.127.ari/include
          -idir /opt/cray/xpmem/0.1-2.0502.55507.3.2.ari/include
          -idir /opt/cray/gni-headers/3.0-1.0502.9684.5.2.ari/include
          -idir /opt/cray/pmi/5.0.4-1.0000.10161.132.4.ari/include
          -idir /opt/cray/ugni/5.0-1.0502.9685.4.24.ari/include
          -idir /opt/cray/udreg/2.3.2-1.0502.9275.1.12.ari/include
          -idir /opt/cray/alps/5.2.1-2.0502.9072.13.1.ari/include
          -idir /opt/cray/wlm_detect/1.0-1.0502.53341.1.1.ari/include
          -idir /opt/cray/alps/5.2.1-2.0502.9072.13.1.ari/include
          -idir /opt/cray/krca/1.0.0-2.0502.53880.4.104.ari/include
          -idir /opt/cray-hss-devel/7.2.0/include
          -inform severe -opt 0 -nosave -object -noonetrip
          -depchk on -nostandard     
          -symbol -noupcase    

Filename: ../../../External/LS/EOS_M4C_MODULE.f90

(    1) !-----------------------------------------------------------------------
(    2) !    MODULE:       eos_m4c_module
(    3) !    Author:       S. W. Bruenn
(    4) !    Date:         10/26/02
(    5) !-----------------------------------------------------------------------
(    6) MODULE eos_m4c_module
(    7) 
(    8) USE wlKindModule, ONLY: double => dp
(    9) 
(   10) !-----------------------------------------------------------------------
(   11) !
(   12) !               \\\\\ INPUT & OUTPUT VARIBLES /////
(   13) !
(   14) !-----------------------------------------------------------------------
(   15) 
(   16) INTEGER                                         :: ADFLAG, NEWFLG, NGFLAG
(   17) INTEGER                                         :: NF_FLG, RSFLAG, DBFLAG
(   18) 
(   19) !-----------------------------------------------------------------------
(   20) !
(   21) !                    \\\\\ LOCAL VARIABLES /////
(   22) !
(   23) !-----------------------------------------------------------------------
(   24) 
(   25) !-----------------------------------------------------------------------
(   26) !  Flag used internally to this routine to record whether or not another
(   27) !   scheme has already been tried
(   28) !-----------------------------------------------------------------------
(   29) 
(   30) INTEGER                                         :: SWTFLG
(   31) 
(   32) !-----------------------------------------------------------------------
(   33) !  XACC - Accuracy in X
(   34) !-----------------------------------------------------------------------
(   35) 
(   36) REAL(KIND=double), PARAMETER                    :: XACC = 1.0D-8
(   37) 
(   38) !-----------------------------------------------------------------------
(   39) !  Maximum number of X iterations






PGF90 (Version     14.9)          03/12/2015  00:11:49      page 2

(   40) !-----------------------------------------------------------------------
(   41) 
(   42) INTEGER, PARAMETER                              :: MAXIT = 200
(   43) 
(   44) !-----------------------------------------------------------------------
(   45) !  Update flag
(   46) !-----------------------------------------------------------------------
(   47) 
(   48) INTEGER, PARAMETER                              :: UPFLAG = 3
(   49) 
(   50) !-----------------------------------------------------------------------
(   51) !  External Interaction flag
(   52) !     1 = on, 0 = off
(   53) !-----------------------------------------------------------------------
(   54) 
(   55) REAL(KIND=double), PARAMETER                    :: EIFLAG = 1.0D+00
(   56) 
(   57) !-----------------------------------------------------------------------
(   58) !  Alpha particle enable flag
(   59) !     1= alphas, 0 = no alphas
(   60) !-----------------------------------------------------------------------
(   61) 
(   62) INTEGER, PARAMETER                              :: ALFLAG = 1
(   63) 
(   64) !-----------------------------------------------------------------------
(   65) !  Translational energy scaling factor
(   66) !     1 = on, 0 = off
(   67) !-----------------------------------------------------------------------
(   68) 
(   69) REAL(KIND=double), PARAMETER                    :: TRSCAL = 1.0D+00
(   70) 
(   71) !-----------------------------------------------------------------------
(   72) !  Surface and Coulomb scaling factor
(   73) !     1.0 = on, 0 = off
(   74) !-----------------------------------------------------------------------
(   75) 
(   76) REAL(KIND=double), PARAMETER                    :: CSSCAL = 1.0D+00
(   77) 
(   78) !-----------------------------------------------------------------------
(   79) !  Cutoff fraction of nuclei (If XH is below this the "no nuclei" scheme
(   80) !   is used)
(   81) !-----------------------------------------------------------------------
(   82) 
(   83) REAL(KIND=double), PARAMETER                    :: HEAVCT = 1.0D-6
(   84) 
(   85) !-----------------------------------------------------------------------
(   86) !  Iteration loop variables
(   87) !-----------------------------------------------------------------------
(   88) 
(   89) INTEGER                                         :: I, J, L, IT_NUM
(   90) 
(   91) !-----------------------------------------------------------------------
(   92) !  Combination of Coulomb and Surface coefficients
(   93) !-----------------------------------------------------------------------
(   94) 
(   95) REAL(KIND=double), PARAMETER                    :: ALPHA = 224.4D+00
(   96) REAL(KIND=double), PARAMETER                    :: BETA = 1.3927D+00
(   97) 






PGF90 (Version     14.9)          03/12/2015  00:11:49      page 3

(   98) !-----------------------------------------------------------------------
(   99) !  Surface tension (MeV/fm**2)
(  100) !-----------------------------------------------------------------------
(  101) 
(  102) REAL(KIND=double), PARAMETER                    :: SIG_0 = 46.5D+00
(  103) 
(  104) !-----------------------------------------------------------------------
(  105) !  Binding energy of alpha particles [MeV]
(  106) !-----------------------------------------------------------------------
(  107) 
(  108) REAL(KIND=double), PARAMETER                    :: BALPHA = 28.3D+00
(  109) REAL(KIND=double), PARAMETER                    :: V_ALFA = 24.0D+00
(  110) 
(  111) !-----------------------------------------------------------------------
(  112) !  Nuclear symmetry energy [MeV]
(  113) !-----------------------------------------------------------------------
(  114) 
(  115) REAL(KIND=double), PARAMETER                    :: SV = 29.3D+00
(  116) 
(  117) !-----------------------------------------------------------------------
(  118) !  Nuclear compression modulus [MeV]
(  119) !-----------------------------------------------------------------------
(  120) 
(  121) REAL(KIND=double), PARAMETER                    :: COMPRS = 370.0D+00
(  122) REAL(KIND=double)                               :: K
(  123) 
(  124) !-----------------------------------------------------------------------
(  125) !  Nuclear level density (per MeV)
(  126) !-----------------------------------------------------------------------
(  127) 
(  128) REAL(KIND=double), PARAMETER                    :: LEVDNS = 0.0666667D+00
(  129) REAL(KIND=double)                               :: AV
(  130) 
(  131) !-----------------------------------------------------------------------
(  132) !  Approximate size of nuclei
(  133) !-----------------------------------------------------------------------
(  134) 
(  135) REAL(KIND=double), PARAMETER                    :: AZERO = 60.0D+00
(  136) 
(  137) !-----------------------------------------------------------------------
(  138) !  Plancks constant & speed of light
(  139) !-----------------------------------------------------------------------
(  140) 
(  141) REAL(KIND=double), PARAMETER                    :: HBAR = 6.58217317D-22
(  142) REAL(KIND=double), PARAMETER                    :: C = 2.997924581D+23
(  143) 
(  144) !-----------------------------------------------------------------------
(  145) !  Pi and square root of Pi
(  146) !-----------------------------------------------------------------------
(  147) 
(  148) REAL(KIND=double), PARAMETER                    :: PI = 3.1415927D+00
(  149) REAL(KIND=double), PARAMETER                    :: ROOTPI = 1.7724539D+00
(  150) 
(  151) !-----------------------------------------------------------------------
(  152) !  Square root of two
(  153) !-----------------------------------------------------------------------
(  154) 
(  155) REAL(KIND=double), PARAMETER                    :: ROOT2 = 1.4142136D+00






PGF90 (Version     14.9)          03/12/2015  00:11:49      page 4

(  156) 
(  157) !-----------------------------------------------------------------------
(  158) !  Parameters containing powers of 1/3
(  159) !-----------------------------------------------------------------------
(  160) 
(  161) REAL(KIND=double), PARAMETER                    :: OVR3 = 0.33333333D+00
(  162) REAL(KIND=double), PARAMETER                    :: OVR23 = 0.66666666D+00
(  163) REAL(KIND=double), PARAMETER                    :: OVR43 = 1.33333333D+00
(  164) REAL(KIND=double), PARAMETER                    :: OVR53 = 1.66666667D+00
(  165) REAL(KIND=double), PARAMETER                    :: OVR29 = 0.2222222222D+00
(  166) REAL(KIND=double), PARAMETER                    :: OVR49 = 0.44444444D+00
(  167) REAL(KIND=double), PARAMETER                    :: MOVR3 = -0.33333333D+00
(  168) REAL(KIND=double), PARAMETER                    :: M2OVR3 = -0.66666666D+00
(  169) REAL(KIND=double), PARAMETER                    :: M4OVR3 = -1.33333333D+00
(  170) REAL(KIND=double), PARAMETER                    :: M5OVR3 = -1.666666667D+00
(  171) 
(  172) !-----------------------------------------------------------------------
(  173) !  Ratio of baryon density to saturation density
(  174) !-----------------------------------------------------------------------
(  175) 
(  176) REAL(KIND=double)                               :: Y
(  177) REAL(KIND=double)                               :: TFINAL
(  178) 
(  179) !-----------------------------------------------------------------------
(  180) !  Quantum concentration & Fermi integral coefficent
(  181) !-----------------------------------------------------------------------
(  182) 
(  183) REAL(KIND=double)                               :: NQ, MQ, LQ, KQ, UQ
(  184) 
(  185) !-----------------------------------------------------------------------
(  186) !  Estimate of X (used in "no nuclei" scheme)
(  187) !-----------------------------------------------------------------------
(  188) 
(  189) REAL(KIND=double)                               :: XGUESS
(  190) 
(  191) !-----------------------------------------------------------------------
(  192) !  Cutoff used to determine how to calc the number density of heavy
(  193) !   nuclei (used in the "no nuclei" scheme)
(  194) !-----------------------------------------------------------------------
(  195) 
(  196) REAL(KIND=double), PARAMETER                    :: MHCUT = 30.0D+00
(  197) REAL(KIND=double)                               :: MHOVT
(  198) 
(  199) !-----------------------------------------------------------------------
(  200) !  Chem. pot., mass, # density, & quantum concentration of heavy nuclei
(  201) !   (used in the "no nuclei" scheme)
(  202) !-----------------------------------------------------------------------
(  203) 
(  204) REAL(KIND=double)                               :: MUHEAV, NUCQ, MASSHV, NHEAVY
(  205) 
(  206) !-----------------------------------------------------------------------
(  207) !  Bulk nuclear pressures
(  208) !-----------------------------------------------------------------------
(  209) 
(  210) REAL(KIND=double)                               :: PSUBI, POVRNI
(  211) 
(  212) !-----------------------------------------------------------------------
(  213) !  Neutron & proton rest masses






PGF90 (Version     14.9)          03/12/2015  00:11:49      page 5

(  214) !-----------------------------------------------------------------------
(  215) 
(  216) REAL(KIND=double), PARAMETER                    :: MASSN = 939.5731D+00
(  217) REAL(KIND=double), PARAMETER                    :: MASSP = 938.2796D+00
(  218) 
(  219) !-----------------------------------------------------------------------
(  220) !  Saturation density, nuclear density, the difference of the two and
(  221) !   their ratio
(  222) !-----------------------------------------------------------------------
(  223) 
(  224) REAL(KIND=double)                               :: NSUBI, N_I, DNI, NRATIO, N_IOLD, NIOLD
(  225) 
(  226) !-----------------------------------------------------------------------
(  227) !  Surface energy coefficants
(  228) !-----------------------------------------------------------------------
(  229) 
(  230) REAL(KIND=double)                               :: N_S, Q, R_0, ZETA_0
(  231) 
(  232) !-----------------------------------------------------------------------
(  233) !  Coulomb liquid correction functions & derivatives
(  234) !-----------------------------------------------------------------------
(  235) 
(  236) REAL(KIND=double)                               :: W, DWDX, DWDT, DWDTDX, DWDXDX, DWDTDT
(  237) REAL(KIND=double)                               :: TZERO, DTZDX, DTZDXX
(  238) 
(  239) !-----------------------------------------------------------------------
(  240) !  Coulomb functions and derivatives
(  241) !-----------------------------------------------------------------------
(  242) 
(  243) REAL(KIND=double)                               :: DU, DMU, DUP, DMUP, DUPP, DMUPP
(  244) REAL(KIND=double)                               :: DUX, DMUX, DUPX, DMUPX
(  245) REAL(KIND=double)                               :: DUT, DMUT, DUPT, DMUPT, DUPPT
(  246) REAL(KIND=double)                               :: DUXT, DMUXT
(  247) REAL(KIND=double)                               :: DUXX, DMUXX, DUTT, DMUTT
(  248) 
(  249) REAL(KIND=double)                               :: SCRDU, SCRDUP, SCRDPP, SCRD, SCRD2
(  250) REAL(KIND=double)                               :: SCRDUT, SCRDUX, SCRDXX, SCRDT, SCRDX, SCRDXT
(  251) REAL(KIND=double)                               :: SCRDTT
(  252) REAL(KIND=double)                               :: SCRD2T, SCRD2X, SCRDPT, SCRDPX
(  253) REAL(KIND=double)                               :: UTILDE, DUTIL, DUTILP, OMEG_R
(  254) 
(  255) !-----------------------------------------------------------------------
(  256) !  Finite size energy coefficent
(  257) !-----------------------------------------------------------------------
(  258) 
(  259) REAL(KIND=double)                               :: ZETA, DZDT, DZDX, DZDNI
(  260) 
(  261) !-----------------------------------------------------------------------
(  262) !  Equilibrium equation finite size terms
(  263) !-----------------------------------------------------------------------
(  264) 
(  265) REAL(KIND=double)                               :: BN, BP, BSUBP
(  266) 
(  267) !-----------------------------------------------------------------------
(  268) !  Baryon densities
(  269) !-----------------------------------------------------------------------
(  270) 
(  271) REAL(KIND=double)                               :: NNOUT, ALFDNS, NUCDNS, NOUT






PGF90 (Version     14.9)          03/12/2015  00:11:49      page 6

(  272) 
(  273) !-----------------------------------------------------------------------
(  274) !  Baryon fractions
(  275) !-----------------------------------------------------------------------
(  276) 
(  277) REAL(KIND=double)                               :: XALFA, XNUT, XPROT, XH, XHCHK
(  278) REAL(KIND=double)                               :: XALFA2, XNUT2, XPROT2
(  279) 
(  280) !-----------------------------------------------------------------------
(  281) !  Fraction of space occupied by nuclei
(  282) !-----------------------------------------------------------------------
(  283) 
(  284) REAL(KIND=double)                               :: U_NUC, U_N, COMPU, RY
(  285) 
(  286) !-----------------------------------------------------------------------
(  287) !  Fraction of space available to remaining baryons  (1-U_NUC)
(  288) !-----------------------------------------------------------------------
(  289) 
(  290) REAL(KIND=double)                               :: EXALFA, EXCLU
(  291) 
(  292) !-----------------------------------------------------------------------
(  293) !  Surface tension variables
(  294) !-----------------------------------------------------------------------
(  295) 
(  296) REAL(KIND=double)                               :: COMPX, SIGMA, AHBN, OVRX4, DSIGDX, DSGRDX, SIGSGP
(  297) REAL(KIND=double)                               :: SIGSG2
(  298) 
(  299) !-----------------------------------------------------------------------
(  300) !  Critical temperature variables
(  301) !-----------------------------------------------------------------------
(  302) 
(  303) REAL(KIND=double)                               :: TSUBC, TSC1, DTCDX, DTCDXX, TSC_12
(  304) 
(  305) !-----------------------------------------------------------------------
(  306) !  Surface & translational temperature variables
(  307) !-----------------------------------------------------------------------
(  308) 
(  309) REAL(KIND=double)                               :: DHDX, DHDXX, HX, DHDTDX, CHOVA
(  310) REAL(KIND=double)                               :: H, HPRIM, HPPRIM
(  311) REAL(KIND=double)                               :: CAPH, CAPHP
(  312) 
(  313) !-----------------------------------------------------------------------
(  314) !  Neutron-Proton mass difference
(  315) !-----------------------------------------------------------------------
(  316) 
(  317) REAL(KIND=double), PARAMETER                    :: DELTAM = -1.2935D+00
(  318) 
(  319) !-----------------------------------------------------------------------
(  320) !  Chemical potentials
(  321) !-----------------------------------------------------------------------
(  322) 
(  323) REAL(KIND=double)                               :: MUHAT, MUN, MUNOVT, MUALFA, MUPROT, MUN_I
(  324) REAL(KIND=double)                               :: MUP_I, MUN_O, MUP_O, MUN_Z, MUP_Z
(  325) REAL(KIND=double)                               :: ETA_NO, ETA_PO, ETA_NI, ETA_PI, ETAMAX
(  326) REAL(KIND=double)                               :: ETP_HI, ETP_LO, ETN_HI, ETN_LO
(  327) REAL(KIND=double)                               :: DELTMN, DELTMP, DELTAP
(  328) 
(  329) REAL(KIND=double)                               :: DMNDPI, DMPDPI, DPIDNI






PGF90 (Version     14.9)          03/12/2015  00:11:49      page 7

(  330) 
(  331) REAL(KIND=double)                               :: OMEGA
(  332) 
(  333) REAL(KIND=double)                               :: DETA_P, DETA_N, NETA_N, NETA_P
(  334) REAL(KIND=double)                               :: CHNG_N, CHNG_P
(  335) 
(  336) !-----------------------------------------------------------------------
(  337) !  Chemical potentials
(  338) !-----------------------------------------------------------------------
(  339) 
(  340) REAL(KIND=double)                               :: VNOUT, VPOUT, VNI, VPI
(  341) REAL(KIND=double)                               :: ZNO, ZPO, ZNI, ZPI
(  342) 
(  343) !-----------------------------------------------------------------------
(  344) !  Nucleon kinetic energy densities
(  345) !-----------------------------------------------------------------------
(  346) 
(  347) REAL(KIND=double)                               :: TAU_PO, TAU_NO, TAU_NI, TAU_PI
(  348) REAL(KIND=double)                               :: F32_PO, F32_NO, F32_NI, F32_PI
(  349) REAL(KIND=double)                               :: FRAT_N, FRAT_P
(  350) 
(  351) !-----------------------------------------------------------------------
(  352) !  Newton-Raphson equation variables
(  353) !-----------------------------------------------------------------------
(  354) 
(  355) REAL(KIND=double)                               :: G, DGDX, DGDPRT, GOLD
(  356) 
(  357) !-----------------------------------------------------------------------
(  358) !  Atomic weight & number
(  359) !-----------------------------------------------------------------------
(  360) 
(  361) REAL(KIND=double)                               :: A, Z
(  362) 
(  363) !-----------------------------------------------------------------------
(  364) !  Nuclear radius & volume
(  365) !-----------------------------------------------------------------------
(  366) 
(  367) REAL(KIND=double)                               :: RSUBN, VSUBN
(  368) 
(  369) !-----------------------------------------------------------------------
(  370) !  Surface, Coulomb, translational, and bulk free energies (per baryon)
(  371) !-----------------------------------------------------------------------
(  372) 
(  373) REAL(KIND=double)                               :: FSUBS, FSUBC, FSUBSC, FSUBI, FTRANS, MUSUBT
(  374) REAL(KIND=double)                               :: DMUTDT
(  375) 
(  376) REAL(KIND=double)                               :: FTR, DFTRDT, DFTRDU, DFTRDX, DFTRDN
(  377) REAL(KIND=double)                               :: F_SC, DFSCDT, DFSCDU, DFSCDX, DFSCDN
(  378) 
(  379) REAL(KIND=double)                               :: E_TR, DETRDT, DETRDU, DETRDX, DETRDN
(  380) REAL(KIND=double)                               :: E_SC, DESCDT, DESCDU, DESCDX, DESCDN
(  381) 
(  382) REAL(KIND=double)                               :: S_TR, DSTRDT, DSTRDU, DSTRDX, DSTRDN
(  383) REAL(KIND=double)                               :: S_SC, DSSCDT, DSSCDU, DSSCDX, DSSCDN
(  384) 
(  385) REAL(KIND=double)                               :: S_NUC, S_OUT, S_ALFA
(  386) REAL(KIND=double)                               :: E_NUC, E_OUT, E_ALFA
(  387) 






PGF90 (Version     14.9)          03/12/2015  00:11:49      page 8

(  388) REAL(KIND=double)                               :: S_DENS, E_DENS
(  389) 
(  390) REAL(KIND=double)                               :: DETPDX, DETNDX, DETPDN, DETNDN
(  391) REAL(KIND=double)                               :: DTPIDX, DTNIDX, DTPDNI, DTNDNI
(  392) 
(  393) REAL(KIND=double)                               :: DSIDT, DSIDX, DSIDN, DEIDT, DEIDX, DEIDN
(  394) 
(  395) REAL(KIND=double)                               :: DSODT, DSODEP, DSODEN, DEODT, DEODEP, DEODEN
(  396) 
(  397) REAL(KIND=double)                               :: DSADT, DSADEP, DSADEN, DEADT, DEADEP, DEADEN
(  398) 
(  399) REAL(KIND=double)                               :: DNPDEP, DNPDEN, DNNDEP, DNNDEN
(  400) REAL(KIND=double)                               :: DTPDEP, DTPDEN, DTNDEP, DTNDEN
(  401) 
(  402) !-----------------------------------------------------------------------
(  403) !
(  404) !               \\\\\ BARYON THERMODYNAMIC VARIABLES /////
(  405) !
(  406) !-----------------------------------------------------------------------
(  407) 
(  408) !-----------------------------------------------------------------------
(  409) !  Pressures
(  410) !-----------------------------------------------------------------------
(  411) 
(  412) REAL(KIND=double)                               :: BPRESS, BPROUT, BPRNUC, BPRALF
(  413) 
(  414) !-----------------------------------------------------------------------
(  415) !  Entropies (per baryon)
(  416) !-----------------------------------------------------------------------
(  417) 
(  418) REAL(KIND=double)                               :: BSOUT, BSNUC, BS, BSALFA
(  419) REAL(KIND=double)                               :: DSFSDU, DSFSDX, DSFSDN, DSFSDT
(  420) 
(  421) REAL(KIND=double)                               :: DBSODT, DBSNDT, DBSADT, SFS_DT
(  422) 
(  423) !-----------------------------------------------------------------------
(  424) !  Internal energies (per baryon)
(  425) !-----------------------------------------------------------------------
(  426) 
(  427) REAL(KIND=double)                               :: BUOUT, BUNUC, BU, BUALFA
(  428) 
(  429) !-----------------------------------------------------------------------
(  430) !  Helmholtz free energies (per baryon)
(  431) !-----------------------------------------------------------------------
(  432) 
(  433) REAL(KIND=double)                               :: BFOUT, BFALFA, BFNUC, BFTOT
(  434) 
(  435) !-----------------------------------------------------------------------
(  436) !  Adiabatic index
(  437) !-----------------------------------------------------------------------
(  438) 
(  439) REAL(KIND=double)                               :: GAM_S
(  440) 
(  441) !-----------------------------------------------------------------------
(  442) !
(  443) !            \\\\\ TOTAL ENERGY, ENTROPY, AND PRESSURE /////
(  444) !
(  445) !-----------------------------------------------------------------------






PGF90 (Version     14.9)          03/12/2015  00:11:49      page 9

(  446) 
(  447) REAL(KIND=double)                               :: UTOT, STOT, PTOT, FTOT
(  448) REAL(KIND=double)                               :: FBARY, PBARY, MUBARY, MU_MAT
(  449) 
(  450) !-----------------------------------------------------------------------
(  451) !
(  452) !                       \\\\\ X VARIABLES /////
(  453) !
(  454) !-----------------------------------------------------------------------
(  455) 
(  456) !-----------------------------------------------------------------------
(  457) !  Internal proton fraction (in nuclei)
(  458) !-----------------------------------------------------------------------
(  459) 
(  460) REAL(KIND=double)                               :: X
(  461) 
(  462) !-----------------------------------------------------------------------
(  463) !  Outside proton fraction (nucleon vapor)
(  464) !-----------------------------------------------------------------------
(  465) 
(  466) REAL(KIND=double)                               :: XOUT
(  467) 
(  468) REAL(KIND=double)                               :: XNEW, XOLD, DX
(  469) 
(  470) !-----------------------------------------------------------------------
(  471) !  Limits on X
(  472) !-----------------------------------------------------------------------
(  473) 
(  474) REAL(KIND=double)                               :: X_MIN
(  475) 
(  476) !-----------------------------------------------------------------------
(  477) !
(  478) !                     \\\\\ PROTON VARIABLES /////
(  479) !
(  480) !-----------------------------------------------------------------------
(  481) 
(  482) REAL(KIND=double)                               :: NPOUT, PRTNEW, PRTOLD, DPRT
(  483) 
(  484) !-----------------------------------------------------------------------
(  485) !  Diagonal line in the temp-density plane
(  486) !-----------------------------------------------------------------------
(  487) 
(  488) REAL(KIND=double)                               :: TCHECK
(  489) 
(  490) !-----------------------------------------------------------------------
(  491) !  Temporary storage variables
(  492) !-----------------------------------------------------------------------
(  493) 
(  494) REAL(KIND=double)                               :: TMP1, TMP1P, TMP1PP
(  495) REAL(KIND=double)                               :: TMP2, TMP2P, TMP2PP, TMP2PT, TMP2PX
(  496) REAL(KIND=double)                               :: TMP2T, TMP2X, TMP2XX, TMP2XT, TMP2TT
(  497) REAL(KIND=double)                               :: TMP3, TMP3P, TMP3PP, TMP3PT, TMP3PX
(  498) REAL(KIND=double)                               :: TMP3T, TMP3X, TMP3XX, TMP3XT, TMP3TT
(  499) REAL(KIND=double)                               :: TMP4, TMP5
(  500) 
(  501) REAL(KIND=double)                               :: NSUBIN, NETAP, NETAN
(  502) 
(  503) REAL(KIND=double), PARAMETER                    :: NSIACC = 1.0D-8






PGF90 (Version     14.9)          03/12/2015  00:11:49      page 10

(  504) REAL(KIND=double), PARAMETER                    :: PRTACC = 1.0D-9
(  505) REAL(KIND=double), PARAMETER                    :: NUTACC = 1.0D-9
(  506) 
(  507) REAL(KIND=double)                               :: DETERM
(  508) 
(  509) REAL(KIND=double)                               :: DNSUBI, DETAP, DETAN
(  510) 
(  511) REAL(KIND=double)                               :: A1, A2, A3
(  512) 
(  513) REAL(KIND=double)                               :: A1H, A1L, DA1DN, DA1ETP, DA1ETN
(  514) REAL(KIND=double)                               :: A2H, A2L, DA2DN, DA2ETP, DA2ETN
(  515) REAL(KIND=double)                               :: A3H, A3L, DA3DN, DA3ETP, DA3ETN
(  516) !
(  517) !+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
(  518) !
(  519) REAL(KIND=double)                               :: GPI,GNI,GPO,GNO
(  520) REAL(KIND=double)                               :: DVPIDP, DVPIDN, DVNIDP, DVNIDN
(  521) REAL(KIND=double)                               :: DVPODP, DVPODN, DVNODP, DVNODN
(  522) REAL(KIND=double)                               :: MSSCON
(  523) REAL(KIND=double)                               :: DTPIDP, DTPIDN, DTNIDP, DTNIDN
(  524) REAL(KIND=double)                               :: DTPODP, DTPODN, DTNODP, DTNODN
(  525) REAL(KIND=double)                               :: DMPIDP, DMPIDN, DMNIDP, DMNIDN
(  526) REAL(KIND=double)                               :: DMPODP, DMPODN, DMNODP, DMNODN
(  527) REAL(KIND=double)                               :: DPIDP, DPIDN, DPODP, DPODN, DPADP, DPADN
(  528) REAL(KIND=double)                               :: N1, N2, DUDPO, DUDNO, DUDNI
(  529) REAL(KIND=double)                               :: DXDPO, DXDNO, DXDNI
(  530) REAL(KIND=double)                               :: DB1DNI, DB1DX, DB1DU
(  531) REAL(KIND=double)                               :: DB2DNI, DB2DX, DB2DU
(  532) REAL(KIND=double)                               :: DB3DNI, DB3DX, DB3DU
(  533) REAL(KIND=double)                               :: DA1ID1, DA1ID2, DA1ID3, DA1OD1, DA1OD2, DA1OD3
(  534) REAL(KIND=double)                               :: DA2ID1, DA2ID2, DA2ID3, DA2OD1, DA2OD2, DA2OD3
(  535) REAL(KIND=double)                               :: DA3ID1, DA3ID2, DA3ID3, DA3OD1, DA3OD2, DA3OD3
(  536) REAL(KIND=double)                               :: DA1D1, DA1D2, DA1D3, DB1D1, DB1D2, DB1D3
(  537) REAL(KIND=double)                               :: DA2D1, DA2D2, DA2D3, DB2D1, DB2D2, DB2D3
(  538) REAL(KIND=double)                               :: DA3D1, DA3D2, DA3D3, DB3D1, DB3D2, DB3D3
(  539) REAL(KIND=double)                               :: DNDETN, DPDETP
(  540) !
(  541) !+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
(  542) !
(  543) !
(  544) !
(  545) !/////////////////////////////////////////////////////////////////////
(  546) !                   Derivative variables
(  547) !/////////////////////////////////////////////////////////////////////
(  548) !
(  549) !
(  550) 
(  551) !-----------------------------------------------------------------------
(  552) !  Temperature derivatives
(  553) !-----------------------------------------------------------------------
(  554) 
(  555) REAL(KIND=double)                               :: DMPODT, DMNODT, DMPIDT, DMNIDT
(  556) REAL(KIND=double)                               :: DNADPO, DNADNO
(  557) 
(  558) REAL(KIND=double)                               :: DTPIDT, DTNIDT, DTPODT, DTNODT
(  559) REAL(KIND=double)                               :: DPODT, DPIDT
(  560) 
(  561) REAL(KIND=double)                               :: DNPODT, DNNODT






PGF90 (Version     14.9)          03/12/2015  00:11:49      page 11

(  562) 
(  563) REAL(KIND=double)                               :: DV_DT
(  564) 
(  565) REAL(KIND=double)                               :: DNADT, DPADT, DMUADT
(  566) 
(  567) REAL(KIND=double)                               :: DU_DT, DX_DT, DNI_DT, DEP_DT, DEN_DT
(  568) 
(  569) REAL(KIND=double)                               :: DU_DN, DX_DN, DNI_DN, DEP_DN, DEN_DN
(  570) 
(  571) REAL(KIND=double)                               :: DU_DY, DX_DY, DNI_DY, DEP_DY, DEN_DY
(  572) 
(  573) REAL(KIND=double)                               :: DNA_DT, DNA_DY, DNA_DN
(  574) 
(  575) REAL(KIND=double)                               :: DB1DT, DB2DT, DB3DT
(  576) 
(  577) !-----------------------------------------------------------------------
(  578) !  Exterior particle density derivatives
(  579) !-----------------------------------------------------------------------
(  580) 
(  581) REAL(KIND=double)                               :: DV_DPO, DV_DNO
(  582) 
(  583) 
(  584) !-----------------------------------------------------------------------
(  585) !  ETA derivatives
(  586) !-----------------------------------------------------------------------
(  587) 
(  588) REAL(KIND=double)                               :: DMPDEP, DMPDEN, DMNDEP, DMNDEN
(  589) 
(  590) REAL(KIND=double)                               :: DV_DEP, DV_DEN
(  591) 
(  592) REAL(KIND=double)                               :: DNADEP, DNADEN, DPADEP, DPADEN
(  593) 
(  594) REAL(KIND=double)                               :: DPODEP, DPODEN
(  595) 
(  596) REAL(KIND=double)                               :: DNPODN, DNPIDN, DNNIDN
(  597) 
(  598) REAL(KIND=double)                               :: DMADEP, DMADEN
(  599) 
(  600) REAL(KIND=double), DIMENSION(5,5)               :: DFDOM, DFDOMI
(  601) REAL(KIND=double), DIMENSION(5)                 :: DFDL_1, DFDL_2, DFDL_3
(  602) 
(  603) REAL(KIND=double)                               :: DG1DO1, DG1DO2, DG2DO1, DG2DO2, DET_GT
(  604) REAL(KIND=double)                               :: DG1DL1, DG1DL2, DG1DL3
(  605) REAL(KIND=double)                               :: DG2DL1, DG2DL2, DG2DL3
(  606) 
(  607) REAL(KIND=double)                               :: A_1X, A_1U, A_1N
(  608) REAL(KIND=double)                               :: A_2X, A_2U, A_2N
(  609) REAL(KIND=double)                               :: A_3X, A_3U, A_3N
(  610) REAL(KIND=double)                               :: DET_AL
(  611) 
(  612) REAL(KIND=double)                               :: AT_11, AT_12, AT_13
(  613) REAL(KIND=double)                               :: AT_21, AT_22, AT_23
(  614) REAL(KIND=double)                               :: AT_31, AT_32, AT_33
(  615) 
(  616) REAL(KIND=double)                               :: B_1P, B_2P, B_3P
(  617) REAL(KIND=double)                               :: B_1N, B_2N, B_3N
(  618) 
(  619) REAL(KIND=double)                               :: DNIDPO, DNIDNO






PGF90 (Version     14.9)          03/12/2015  00:11:49      page 12

(  620) 
(  621) REAL(KIND=double)                               :: C_P, C_N, CP_P, CP_N
(  622) REAL(KIND=double)                               :: BB_P, BB_N, BP_P, BP_N
(  623) 
(  624) REAL(KIND=double)                               :: DMP_DN, DMN_DN
(  625) 
(  626) REAL(KIND=double)                               :: DMP_DY, DMN_DY
(  627) 
(  628) REAL(KIND=double)                               :: DFDNDN, DFDYDY, DFDNDY, DFDNDT, DFDYDT
(  629) 
(  630) REAL(KIND=double)                               :: DFDTDT
(  631) 
(  632) REAL(KIND=double)                               :: DBPDT, DBPDN, DBPDY
(  633) 
(  634) REAL(KIND=double)                               :: DBSDT, DBSDN, DBSDY
(  635) 
(  636) REAL(KIND=double)                               :: DBUDT, DBUDN, DBUDY
(  637) 
(  638) REAL(KIND=double)                               :: DBMUDT, DBMUDN, DBMUDY
(  639) 
(  640) REAL(KIND=double)                               :: DMUDT, DMUDN, DMUDY, DSDT, DSDN, DSDY
(  641) REAL(KIND=double)                               :: DPDT, DPDN, DPDY, DUDT, DUDN, DUDY
(  642) 
(  643) REAL(KIND=double)                               :: NPI, NNI, DNPIDT, DNNIDT
(  644) 
(  645) REAL(KIND=double)                               :: DXHDT, DXODT, DXADT
(  646) 
(  647) REAL(KIND=double)                               :: VP_IN, VN_IN
(  648) 
(  649) REAL(KIND=double)                               :: DUODT, DUIDT, DUADT
(  650) 
(  651) REAL(KIND=double)                               :: DBFDT, DBFDY, DBFDN
(  652) !
(  653) !
(  654) !/////////////////////////////////////////////////////////////////////
(  655) !
(  656) !
(  657) !
(  658) !
(  659) !                   This common block contains all of the thermodynamic
(  660) !                   and compositional variables that the EOS code
(  661) !                   calculates & it should be included anywhere
(  662) !                   these variables need to be referenced
(  663) !
(  664) !
(  665) !     COMMON /EOSVAR/ MUN,MUN_I,MUPROT,MUALFA,MUHAT,
(  666) !    1    BU, BS, BPRESS, UTOT, STOT, PTOT,
(  667) !    2    XPROT, XNUT, XALFA, XH, X, A,
(  668) !    3    BUOUT, BUNUC, BPROUT, BPRNUC, BPRALF, BSOUT,BSNUC,BFOUT,
(  669) !    4    BFNUC, BFALFA, FTOT, BFTOT,U_NUC, NSUBI, DNI, RSUBN,
(  670) !    5    VSUBN, FBARY, PBARY, MUBARY, MU_MAT,
(  671) !    6    XALFA2, XNUT2, XPROT2, IT_NUM
(  672) !
(  673) !
(  674) !                    This common contains the variables that are used
(  675) !                    in solving the chemical and pressure equilibrium
(  676) !                    equations
(  677) !






PGF90 (Version     14.9)          03/12/2015  00:11:49      page 13

(  678) !     COMMON /EQLEQN/ NNOUT, NPOUT, NOUT, VNOUT, VPOUT, F32_NO, F32_PO,
(  679) !    1 MUN_O, MUP_O, ALFDNS, COMPX, SIGMA, SIGSGP, DU, DMU, DUP, DMUP,
(  680) !    2 SCRDU, SCRDUP, SCRD, ZETA, FSUBS, FSUBC, MUSUBT, FTRANS, NRATIO,
(  681) !    3 VNI, VPI, ETA_NI, ETA_PI, MUP_I, F32_NI, F32_PI, BN, BP, BSUBP,
(  682) !    4 H, HPRIM, PSUBI, TSUBC, DHDX, DHDXX, SCRD2, SCRDPP, TFINAL
(  683) !
(  684) !
(  685) !                   This common block contains the derivatives of
(  686) !                   the thermodynamic potentials (both baryon and
(  687) !                   the totals)
(  688) !
(  689) !     COMMON /DERIVS/ DBMUDT, DBMUDN, DBMUDY, DMUDT, DMUDN, DMUDY,
(  690) !    1                DBPDT, DBPDN, DBPDY, DPDT, DPDN, DPDY,
(  691) !    2                DBSDT, DBSDN, DBSDY, DSDT, DSDN, DSDY,
(  692) !    3                DBUDT, DBUDN, DBUDY, DUDT, DUDN, DUDY, GAM_S,
(  693) !    4                DU_DT, DX_DT, DNI_DT, DEP_DT, DEN_DT,
(  694) !    5                DU_DY, DX_DY, DNI_DY, DEP_DY, DEN_DY,
(  695) !    6                DU_DN, DX_DN, DNI_DN, DEP_DN, DEN_DN
(  696) !
(  697) !
(  698) !                   This common block contains control flags
(  699) !     COMMON /FLAGS/ ADFLAG, NF_FLG, RSFLAG, DBFLAG
(  700) !
(  701) !
(  702) !                   This common block contains the quality of solution
(  703) !                   variables that determine how "zeroed" the equilbrium
(  704) !                   equations are
(  705) !     COMMON /QCHECK/ A1,A2,A3
(  706) !
(  707) !     double precision ncomp
(  708) !     COMMON /DTEST/ DFDOM, DFDL_1,DFDL_2,DFDL_3,DNA_DT,DNA_DN,DNA_DY,
(  709) !    1 ncomp
(  710) !
(  711) 
(  712) END MODULE eos_m4c_module
