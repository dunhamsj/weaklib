include ../../../Build/Makefile_Build
include $(WEAKLIB_DIR)/TableCreator/OpacitySource/FullWeakPhysics/Makefile_Opacity_FullWeakPhysics_ObjectFiles
include $(WEAKLIB_DIR)/TableCreator/OpacitySource/FullWeakPhysics/Chimera/Makefile_ObjectFiles
include $(WEAKLIB_DIR)/TableCreator/OpacitySource/FullWeakPhysics/Fischer/Makefile_ObjectFiles

VPATH += \
$(WEAKLIB_DIR)/TableCreator/OpacitySource/FullWeakPhysics: \
$(WEAKLIB_DIR)/TableCreator/OpacitySource/FullWeakPhysics/Chimera: \
$(WEAKLIB_DIR)/TableCreator/OpacitySource/FullWeakPhysics/Fischer: \
$(WEAKLIB_DIR)/TableCreator/Old/LS: \
$(WEAKLIB_DIR)/TableCreator/Old/BCK: \
$(WEAKLIB_DIR)/TableCreator/Old/EOSInterface: \
..

Weaklib_TableCreator = \
  $(WL_LIBRARY) \
  $(WL_EOSSOURCE) \
  $(WL_OPACITYSOURCE) \
  $(SHAREDMODULES) \
  $(OPACITYFULLWEAK) \
  $(CHIMERA) \
  $(EOS_MODS) \
  $(EOS_OBJ) \
  $(FULL_KINEMATICS)

GIT_BRANCH := $(shell git branch | grep "^\*" | sed 's/^..//')

GIT_HASH := $(shell git --no-pager describe --tags --always --dirty)
GIT_DATE := $(firstword $(shell git --no-pager show --date=short --format="%ad" --name-only))

#GIT_HASH=`git rev-parse HEAD`
#COMPILE_TIME=`date -u +'%Y-%m-%d %H:%M:%S UTC'`
#GIT_BRANCH=`git branch | grep "^\*" | sed 's/^..//'`
#VERSION_FLAGS = -cpp -DGIT_HASH="\"$(GIT_HASH)\"" -DGIT_DATE="\"$(GIT_DATE)\"" -DGIT_BRANCH="\"$(GIT_BRANCH)\""

VERSION_FLAGS = -cpp -DGIT_HASH="\"$(GIT_HASH)\"" -DGIT_DATE="\"$(GIT_DATE)\""

all: wlCreateOpacityTable 

wlCreateOpacityTable: \
	$(Weaklib_TableCreator) wlCreateOpacityTable.o
	$(FLINKER) $(FLAGS) -o wlCreateOpacityTable_$(MACHINE) \
	$(Weaklib_TableCreator) wlCreateOpacityTable.o \
	$(LIBRARIES)

clean:
	rm -f *.o *.mod *.ld

clobber: clean
	rm wlCreateOpacityTable_$(MACHINE)
